<!doctype html>
<html lang="th">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="pageTitle">Product Detail - Nexus Wear</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&amp;family=Bebas+Neue&amp;display=swap" rel="stylesheet">
  <style>
        /* CSS ‡πÄ‡∏î‡∏¥‡∏° */
        body {
            box-sizing: border-box;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
            overflow-x: hidden;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #FFFFFF;
            color: #000000;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        .page-wrapper {
            width: 100%;
            min-height: 100%;
        }

        /* Navigation (Re-copied from index.html for consistency) */
        .top-nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #FFFFFF;
            z-index: 1000;
            border-bottom: 2px solid #000000;
        }

        .nav-content {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 60px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 80px;
        }

        .logo-text {
            font-family: 'Bebas Neue', cursive;
            font-size: 28px;
            font-weight: 400;
            letter-spacing: 2px;
            text-decoration: none;
            color: #000000;
            transition: all 0.3s ease;
        }

        .logo-text:hover {
            transform: scale(1.05);
        }

        .main-nav-list {
            display: flex;
            gap: 48px;
            list-style: none;
            align-items: center;
        }

        .nav-link {
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            text-decoration: none;
            color: #000000;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 0;
            height: 3px;
            background: #000000;
            transition: width 0.3s ease;
        }

        .nav-link:hover::after {
            width: 100%;
        }

        .nav-icons {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .icon-btn {
            cursor: pointer;
            transition: all 0.3s ease;
            background: none;
            border: none;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .icon-btn:hover {
            transform: scale(1.15) rotate(5deg);
        }

        .icon-btn:active {
            transform: scale(0.95);
        }

        /* Cart Badge */
        .cart-badge {
            position: absolute;
            top: 2px;
            right: 2px;
            background: #000000;
            color: #FFFFFF;
            font-size: 11px;
            font-weight: 700;
            min-width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 5px;
            pointer-events: none;
            opacity: 0;
            transform: scale(0);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .cart-badge.active {
            opacity: 1;
            transform: scale(1);
        }
        
        /* Product Specific Styles */
        .product-section {
            padding-top: 120px;
            padding-bottom: 80px;
        }

        .product-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 60px;
            display: grid;
            grid-template-columns: 3fr 2fr;
            gap: 80px;
        }

        .product-gallery {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .main-image-wrapper {
            width: 100%;
            aspect-ratio: 1/1;
            background: #F5F5F5;
            border: 2px solid #000000;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .main-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .thumbnail-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }

        .thumbnail-item {
            cursor: pointer;
            border: 2px solid #F5F5F5;
            aspect-ratio: 1/1;
            background: #F5F5F5;
            transition: border-color 0.2s ease, transform 0.2s ease;
            overflow: hidden;
        }

        .thumbnail-item:hover {
            border-color: #999999;
            transform: scale(1.05);
        }

        .thumbnail-item.active {
            border-color: #000000;
        }

        .thumbnail-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .product-details {
            padding-top: 10px;
        }

        .product-category {
            font-size: 14px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: #666666;
            margin-bottom: 8px;
        }

        .product-name {
            font-family: 'Bebas Neue', cursive;
            font-size: 64px;
            font-weight: 400;
            letter-spacing: 3px;
            line-height: 1.1;
            color: #000000;
            margin-bottom: 24px;
        }

        .product-price {
            font-size: 36px;
            font-weight: 800;
            color: #000000;
            margin-bottom: 40px;
        }

        /* Options */
        .option-group {
            margin-bottom: 30px;
        }

        .option-label {
            font-size: 14px;
            font-weight: 700;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 12px;
            display: block;
        }

        .option-pills {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .option-pill {
            padding: 10px 20px;
            border: 2px solid #000000;
            background: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            font-weight: 600;
        }

        .option-pill:hover {
            background: #F5F5F5;
        }

        .option-pill.active {
            background: #000000;
            color: #FFFFFF;
        }
        
        .color-pill {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 2px solid #E0E0E0;
            cursor: pointer;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }
        
        .color-pill.active {
            border-color: #000000;
            box-shadow: 0 0 0 3px #000000;
        }
        
        .color-pill:hover {
            border-color: #000000;
        }

        /* Quantity and Actions */
        .action-group {
            margin-top: 40px;
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .quantity-input-group {
            display: flex;
            border: 2px solid #000000;
            width: 150px;
            flex-shrink: 0;
        }
        
        .qty-btn {
            width: 45px;
            height: 50px;
            background: #FFFFFF;
            border: none;
            font-size: 24px;
            cursor: pointer;
            transition: background 0.2s ease;
            line-height: 1;
        }
        
        .qty-btn:hover {
            background: #F5F5F5;
        }
        
        .qty-input {
            flex-grow: 1;
            border: none;
            text-align: center;
            font-size: 18px;
            font-weight: 600;
            border-left: 2px solid #000000;
            border-right: 2px solid #000000;
            outline: none;
            -moz-appearance: textfield; /* Firefox */
        }
        
        .qty-input::-webkit-outer-spin-button,
        .qty-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        .add-to-cart-btn {
            flex-grow: 1;
            padding: 15px 30px;
            background: #000000;
            color: #FFFFFF;
            border: none;
            font-size: 16px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            cursor: pointer;
            transition: background 0.2s ease, transform 0.2s ease;
        }
        
        .add-to-cart-btn:hover {
            background: #333333;
            transform: translateY(-2px);
        }
        
        .add-to-cart-btn:active {
            transform: translateY(0);
        }

        /* Buy Now button - Optional if needed */
        .buy-now-btn {
            flex-grow: 1;
            padding: 15px 30px;
            background: #FFFFFF;
            color: #000000;
            border: 2px solid #000000;
            font-size: 16px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            cursor: pointer;
            transition: background 0.2s ease;
            margin-top: 10px;
        }

        .buy-now-btn:hover {
            background: #FFF8DC; /* Light yellow hover */
        }

        /* Accordion Details */
        .product-info-details {
            margin-top: 60px;
            border-top: 2px solid #000000;
        }

        .detail-item {
            border-bottom: 1px solid #E0E0E0;
        }

        .detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            cursor: pointer;
            font-size: 18px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .detail-header svg {
            transition: transform 0.3s ease;
        }

        .detail-item.active .detail-header svg {
            transform: rotate(45deg);
        }

        .detail-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-in-out, padding 0.4s ease-in-out;
        }

        .detail-item.active .detail-content {
            max-height: 500px; /* Adjust as needed */
            padding-bottom: 20px;
        }

        .detail-content p {
            font-size: 15px;
            line-height: 1.7;
            color: #333333;
        }

        /* Toast Notification */
        #toast {
            visibility: hidden; 
            min-width: 250px; 
            margin-left: -125px; 
            background-color: #000000; 
            color: #fff; 
            text-align: center; 
            border-radius: 2px; 
            padding: 16px; 
            position: fixed; 
            z-index: 9999; 
            left: 50%; 
            bottom: 30px; 
            font-size: 17px; 
        }

        #toast.show {
            visibility: visible;
            -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }

        @-webkit-keyframes fadein {
            from {bottom: 0; opacity: 0;} 
            to {bottom: 30px; opacity: 1;}
        }

        @keyframes fadein {
            from {bottom: 0; opacity: 0;}
            to {bottom: 30px; opacity: 1;}
        }

        @-webkit-keyframes fadeout {
            from {bottom: 30px; opacity: 1;} 
            to {bottom: 0; opacity: 0;}
        }

        @keyframes fadeout {
            from {bottom: 30px; opacity: 1;}
            to {bottom: 0; opacity: 0;}
        }
        
        .out-of-stock-overlay {
            position: absolute;
            inset: 0;
            background: rgba(255, 255, 255, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 700;
            letter-spacing: 2px;
            color: #E53935;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .main-image-wrapper.out-of-stock .out-of-stock-overlay {
            opacity: 1;
        }


        /* Responsive */
        @media (max-width: 1200px) {
            .product-container {
                grid-template-columns: 1fr;
                gap: 40px;
                padding: 0 40px;
            }
            .product-name {
                font-size: 52px;
            }
            .action-group {
                flex-direction: column;
                align-items: stretch;
            }
            .quantity-input-group {
                width: 100%;
            }
        }

        @media (max-width: 768px) {
            .product-container {
                padding: 0 24px;
            }
            .top-nav {
                height: 70px;
            }
            .product-section {
                padding-top: 100px;
            }
            .product-name {
                font-size: 40px;
            }
            .product-price {
                font-size: 30px;
            }
            .nav-content {
                padding: 0 24px;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body>
  <div id="toast"></div>
  <div class="page-wrapper"><header class="top-nav" role="banner">
    <nav class="nav-content"><a href="index.html" class="logo-text" id="brandLogo">NEXUS WEAR</a>
     <ul class="main-nav-list">
      <li><a href="index.html#new" class="nav-link">New Drops</a></li>
      <li><a href="index.html#collections" class="nav-link">Collections</a></li>
      <li><a href="index.html#about" class="nav-link">About</a></li>
      <li><a href="index.html#contact" class="nav-link">Contact</a></li>
     </ul>
     <div class="nav-icons"><a href="cart.html" class="icon-btn" aria-label="Cart" id="cartBtn">
       <svg width="26" height="26" viewbox="0 0 24 24" fill="none" stroke="#000000" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1" /> <circle cx="20" cy="21" r="1" /> <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6" />
       </svg><span class="cart-badge" id="cartBadge">0</span> </a> <button class="icon-btn" aria-label="Account">
       <svg width="26" height="26" viewbox="0 0 24 24" fill="none" stroke="#000000" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" /> <circle cx="12" cy="7" r="4" />
       </svg></button> <button class="burger-menu" id="burgerBtn" aria-label="Menu"> <span class="burger-line"></span> <span class="burger-line"></span> <span class="burger-line"></span> </button>
     </div>
    </nav>
   </header>
   <main>
    <section class="product-section">
     <div class="product-container">
      <div class="product-gallery">
       <div class="main-image-wrapper" id="mainImageWrapper">
        <img class="main-image" id="mainProductImage" src="https://via.placeholder.com/800x800?text=Loading..." alt="Product Image">
        <div class="out-of-stock-overlay">
         SOLD OUT
        </div>
       </div>
       <div class="thumbnail-grid" id="thumbnailGrid">
        <div class="thumbnail-item active">
         <img src="https://via.placeholder.com/200x200?text=Thumb+1" alt="Thumbnail 1">
        </div>
        <div class="thumbnail-item">
         <img src="https://via.placeholder.com/200x200?text=Thumb+2" alt="Thumbnail 2">
        </div>
        <div class="thumbnail-item">
         <img src="https://via.placeholder.com/200x200?text=Thumb+3" alt="Thumbnail 3">
        </div>
        <div class="thumbnail-item">
         <img src="https://via.placeholder.com/200x200?text=Thumb+4" alt="Thumbnail 4">
        </div>
       </div>
      </div>
      <div class="product-details">
       <p class="product-category" id="productCategory">LOADING...</p>
       <h1 class="product-name" id="productName">PRODUCT NAME</h1>
       <p class="product-price" id="productPrice">‡∏ø0</p>
       <div class="option-group">
        <span class="option-label">SIZE: <span id="selectedSizeLabel"></span></span>
        <div class="option-pills" id="sizeOptions">
         </div>
       </div>
       <div class="option-group">
        <span class="option-label">COLOR: <span id="selectedColorLabel"></span></span>
        <div class="option-pills" id="colorOptions">
         </div>
       </div>
       <div class="action-group">
        <div class="quantity-input-group">
         <button class="qty-btn" id="decreaseQtyBtn">-</button>
         <input type="number" class="qty-input" id="quantityInput" value="1" min="1" max="99" inputmode="numeric">
         <button class="qty-btn" id="increaseQtyBtn">+</button>
        </div>
        <button class="add-to-cart-btn" id="addToCartBtn">ADD TO CART</button>
       </div>
       <button class="buy-now-btn" id="buyNowBtn">BUY NOW</button>
       <div class="product-info-details">
        <div class="detail-item active">
         <div class="detail-header">
          Product Description
          <svg width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19" /> <line x1="5" y1="12" x2="19" y2="12" />
          </svg>
         </div>
         <div class="detail-content">
          <p id="productDescription">Loading product description...</p>
         </div>
        </div>
        <div class="detail-item">
         <div class="detail-header">
          Shipping & Returns
          <svg width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19" /> <line x1="5" y1="12" x2="19" y2="12" />
          </svg>
         </div>
         <div class="detail-content">
          <p>‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 3-5 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£. ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏∑‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 14 ‡∏ß‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤.</p>
         </div>
        </div>
       </div>
      </div>
     </div>
    </section>
   </main>
   </div>
  <script>
    // ====================================================================
    // 1. MOCK PRODUCT DATA (‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏°‡∏≤‡∏à‡∏≤‡∏Å index.html ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö Standalone)
    // ====================================================================
    const MOCK_PRODUCTS_DATA = [
        { id: 'p001', name: 'Vintage Hip Hop Tee', price: 790, description: '‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏¢‡∏∑‡∏î‡∏™‡πÑ‡∏ï‡∏•‡πå Hip Hop ‡∏ß‡∏¥‡∏ô‡πÄ‡∏ó‡∏à, ‡∏Ñ‡∏≠‡∏ï‡∏ï‡∏≠‡∏ô 100% ‡∏ó‡∏£‡∏á Oversize ‡∏™‡∏∏‡∏î‡πÄ‡∏ó‡πà ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ß‡∏°‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô', image: 'https://hnungh.github.io/mcl/img/oversized-tee-black.jpg', category: 'GRAPHIC TEE', available_sizes: ['S', 'M', 'L', 'XL'], available_colors: [{ name: 'Black', hex: '#000000' }, { name: 'White', hex: '#FFFFFF' }], is_available: true },
        { id: 'p002', name: 'Street Cargo Pants', price: 1590, description: '‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á‡∏Ñ‡∏≤‡∏£‡πå‡πÇ‡∏Å‡πâ‡∏ó‡∏£‡∏á‡∏´‡∏•‡∏ß‡∏°‡∏™‡πÑ‡∏ï‡∏•‡πå Military, ‡∏ú‡πâ‡∏≤‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô ‡∏°‡∏µ‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏Ç‡πâ‡∏≤‡∏á‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà', image: 'https://hnungh.github.io/mcl/img/cargo-pants-olive.jpg', category: 'CARGO PANTS', available_sizes: ['S', 'M', 'L', 'XL'], available_colors: [{ name: 'Olive', hex: '#6B8E23' }, { name: 'Black', hex: '#000000' }], is_available: true },
        { id: 'p003', name: 'Oversize Pullover Hoodie', price: 1290, description: '‡∏Æ‡∏π‡πâ‡∏î‡∏î‡∏µ‡πâ‡∏™‡∏ß‡∏°‡∏´‡∏±‡∏ß‡∏ó‡∏£‡∏á Oversize ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ó‡πà ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤ Cotton Fleece ‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏ô‡∏∏‡πà‡∏°', image: 'https://hnungh.github.io/mcl/img/hoodie-grey.jpg', category: 'HOODIE', available_sizes: ['M', 'L', 'XL'], available_colors: [{ name: 'Grey', hex: '#999999' }], is_available: false }, // ‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡πÉ‡∏´‡πâ Out of Stock
        { id: 'p004', name: 'Retro Square Sunglasses', price: 490, description: '‡πÅ‡∏ß‡πà‡∏ô‡∏ï‡∏≤‡∏Å‡∏±‡∏ô‡πÅ‡∏î‡∏î‡∏ó‡∏£‡∏á‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏¢‡πâ‡∏≠‡∏ô‡∏¢‡∏∏‡∏Ñ ‡πÄ‡∏ü‡∏£‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏ô‡∏™‡πå‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á ‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡∏î‡∏ß‡∏á‡∏ï‡∏≤‡∏à‡∏≤‡∏Å‡πÅ‡∏™‡∏á‡πÅ‡∏î‡∏î‡πÑ‡∏î‡πâ‡∏î‡∏µ', image: 'https://hnungh.github.io/mcl/img/sunglasses-retro.jpg', category: 'SUNGLASSES', available_sizes: ['One Size'], available_colors: [{ name: 'Black', hex: '#000000' }, { name: 'Tortoise', hex: '#824510' }], is_available: true }
        // ... (‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ)
    ];

    // ====================================================================
    // 2. CART SYSTEM - LOCAL STORAGE UTILITY (‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏°‡∏≤‡∏à‡∏≤‡∏Å index.html)
    // ====================================================================
    const CART_STORAGE_KEY = 'my_static_shop_cart';

    function getCart() {
        const cartJson = localStorage.getItem(CART_STORAGE_KEY);
        try {
            return cartJson ? JSON.parse(cartJson) : [];
        } catch (e) {
            console.error("Error parsing cart from localStorage:", e);
            return [];
        }
    }

    function saveCart(cart) {
        localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(cart));
        updateCartBadge();
    }
    
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î "Add to Cart"
    function addToCart(productId, name, price, qty = 1, size = '', color = '') {
        const cart = getCart();
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà (‡∏ï‡∏≤‡∏° ID, Size, Color)
        const existingItem = cart.find(item => 
            item.product_id === productId &&
            item.selected_size === size &&
            item.selected_color === color
        );

        if (existingItem) {
            existingItem.qty += qty;
        } else {
            cart.push({ 
                product_id: productId, 
                name, 
                price, 
                qty, 
                selected_size: size, 
                selected_color: color 
            });
        }

        saveCart(cart);
        console.log(`[Cart] Added ${qty} x ${name} (Size: ${size}, Color: ${color}) to cart.`);
        showToast('üõí Added to Cart!');
        return { success: true };
    }

    function getCartCount() {
        return getCart().reduce((total, item) => total + (item.qty || 0), 0);
    }
    
    function updateCartBadge() {
        const totalItems = getCartCount();
        const badgeElement = document.getElementById('cartBadge');
        
        if (badgeElement) {
            badgeElement.textContent = totalItems > 0 ? totalItems : '0';
            if (totalItems > 0) {
                badgeElement.classList.add('active');
            } else {
                badgeElement.classList.remove('active');
            }
        }
    }
    
    // ====================================================================
    // 3. PAGE LOGIC
    // ====================================================================
    
    let currentProduct = null;
    let selectedSize = '';
    let selectedColor = '';
    
    // Utility: ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
    function showToast(message) {
        const toast = document.getElementById('toast');
        if (toast) {
            toast.textContent = message;
            toast.className = "show";
            setTimeout(function(){ toast.className = toast.className.replace("show", ""); }, 3000);
        }
    }
    
    // Utility: ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤ Query Parameter ‡∏à‡∏≤‡∏Å URL
    function getQueryParam(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
    }
    
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å: ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
    function loadProductDataAndRender() {
        const productId = getQueryParam('id');
        
        if (!productId) {
            document.getElementById('productName').textContent = 'Product Not Found';
            document.getElementById('productDescription').textContent = 'Please check the URL parameter.';
            return;
        }

        const product = MOCK_PRODUCTS_DATA.find(p => p.id === productId);

        if (!product) {
            document.getElementById('productName').textContent = 'Product Not Found';
            document.getElementById('productDescription').textContent = `Product ID "${productId}" not found in mock data.`;
            return;
        }
        
        currentProduct = product;
        document.getElementById('pageTitle').textContent = product.name + ' - Nexus Wear';
        document.getElementById('productName').textContent = product.name;
        document.getElementById('productCategory').textContent = product.category;
        document.getElementById('productPrice').textContent = `‡∏ø${product.price.toLocaleString('th-TH')}`;
        document.getElementById('productDescription').textContent = product.description;
        document.getElementById('mainProductImage').src = product.image;
        document.getElementById('mainProductImage').alt = product.name;

        // ‡∏ñ‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î
        if (product.is_available === false) {
            document.getElementById('mainImageWrapper').classList.add('out-of-stock');
            document.getElementById('addToCartBtn').disabled = true;
            document.getElementById('addToCartBtn').textContent = 'OUT OF STOCK';
            document.getElementById('buyNowBtn').disabled = true;
        }
        
        // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Size/Color ‡πÅ‡∏£‡∏Å‡πÄ‡∏õ‡πá‡∏ô Default
        selectedSize = product.available_sizes[0] || '';
        selectedColor = product.available_colors[0] ? product.available_colors[0].name : '';

        renderSizeOptions(product.available_sizes);
        renderColorOptions(product.available_colors);
        updateSelectedLabels();
        renderThumbnails(product.image); // ‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô
    }
    
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Size
    function renderSizeOptions(sizes) {
        const sizeContainer = document.getElementById('sizeOptions');
        sizeContainer.innerHTML = '';
        document.getElementById('selectedSizeLabel').textContent = sizes[0] || 'N/A'; // Default selection
        
        sizes.forEach(size => {
            const pill = document.createElement('div');
            pill.className = `option-pill ${size === selectedSize ? 'active' : ''}`;
            pill.textContent = size;
            pill.dataset.value = size;
            pill.addEventListener('click', () => {
                selectOption('size', size);
            });
            sizeContainer.appendChild(pill);
        });
    }

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Color
    function renderColorOptions(colors) {
        const colorContainer = document.getElementById('colorOptions');
        colorContainer.innerHTML = '';
        document.getElementById('selectedColorLabel').textContent = colors[0] ? colors[0].name : 'N/A'; // Default selection

        colors.forEach(color => {
            const pill = document.createElement('div');
            pill.className = `color-pill ${color.name === selectedColor ? 'active' : ''}`;
            pill.style.backgroundColor = color.hex;
            pill.dataset.value = color.name;
            pill.title = color.name;
            pill.addEventListener('click', () => {
                selectOption('color', color.name);
            });
            colorContainer.appendChild(pill);
        });
    }
    
    // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Size/Color
    function selectOption(type, value) {
        if (currentProduct.is_available === false) return; // ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏´‡∏°‡∏î

        // Reset active classes
        document.querySelectorAll(`#${type}Options .option-pill, #${type}Options .color-pill`).forEach(pill => {
            pill.classList.remove('active');
        });
        
        // Set new active class
        const selectedPill = document.querySelector(`#${type}Options [data-value="${value}"]`);
        if (selectedPill) {
            selectedPill.classList.add('active');
        }

        if (type === 'size') {
            selectedSize = value;
        } else if (type === 'color') {
            selectedColor = value;
        }
        
        updateSelectedLabels();
    }
    
    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Label ‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á Size/Color ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    function updateSelectedLabels() {
        document.getElementById('selectedSizeLabel').textContent = selectedSize;
        document.getElementById('selectedColorLabel').textContent = selectedColor;
    }
    
    // Mock Thumbnails (‡πÉ‡∏ä‡πâ‡πÅ‡∏Ñ‡πà‡∏£‡∏π‡∏õ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô)
    function renderThumbnails(mainImageSrc) {
        const grid = document.getElementById('thumbnailGrid');
        grid.innerHTML = '';
        
        // ‡∏™‡∏£‡πâ‡∏≤‡∏á 4 Thumbnail ‡∏ó‡∏µ‡πà‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏Å (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Mockup)
        for (let i = 1; i <= 4; i++) {
            const item = document.createElement('div');
            item.className = `thumbnail-item ${i === 1 ? 'active' : ''}`;
            item.innerHTML = `<img src="${mainImageSrc}" alt="Thumbnail ${i}">`;
            item.addEventListener('click', () => {
                // Mock: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ‡∏´‡∏•‡∏±‡∏Å (‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏π‡∏õ)
                document.getElementById('mainProductImage').src = mainImageSrc;
                document.querySelectorAll('.thumbnail-item').forEach(thumb => thumb.classList.remove('active'));
                item.classList.add('active');
            });
            grid.appendChild(item);
        }
    }
    
    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Quantity
    function initializeQuantityControls() {
        const input = document.getElementById('quantityInput');
        const decreaseBtn = document.getElementById('decreaseQtyBtn');
        const increaseBtn = document.getElementById('increaseQtyBtn');

        decreaseBtn.addEventListener('click', () => {
            let currentQty = parseInt(input.value, 10);
            if (currentQty > 1) {
                input.value = currentQty - 1;
            }
        });

        increaseBtn.addEventListener('click', () => {
            let currentQty = parseInt(input.value, 10);
            if (currentQty < 99) { // Max 99
                input.value = currentQty + 1;
            }
        });

        // Ensure minimum 1 and integer
        input.addEventListener('change', () => {
            let val = parseInt(input.value, 10);
            if (isNaN(val) || val < 1) {
                input.value = 1;
            } else if (val > 99) {
                 input.value = 99;
            }
        });
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Add to Cart
    function handleAddToCart() {
        if (currentProduct.is_available === false) {
             showToast('‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î‡∏™‡∏ï‡πá‡∏≠‡∏Å!', 'error');
             return { success: false };
        }
        
        const qty = parseInt(document.getElementById('quantityInput').value, 10);

        if (!selectedSize || !selectedColor) {
             showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Size ‡πÅ‡∏•‡∏∞ Color ‡∏Å‡πà‡∏≠‡∏ô', 'error');
             return { success: false };
        }
        
        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Cart Utility ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ
        const result = addToCart(
            currentProduct.id, 
            currentProduct.name, 
            currentProduct.price, 
            qty, 
            selectedSize, 
            selectedColor
        );

        // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
        if (result.success) {
            // Toast ‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ô addToCart ‡πÅ‡∏•‡πâ‡∏ß
            return result;
        } else {
            showToast('‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤', 'error');
            return result;
        }
    }
    
    // Logic ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Buy Now
    function handleBuyNow() {
        const result = handleAddToCart(); // ‡∏ó‡∏≥‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Add to Cart
        if (result.success) {
            // Redirect ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Cart ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
            window.location.href = 'cart.html';
        }
    }


    // Accordion Logic
    function initializeAccordion() {
        document.querySelectorAll('.detail-header').forEach(header => {
            header.addEventListener('click', () => {
                const item = header.closest('.detail-item');
                item.classList.toggle('active');
            });
        });
    }

    // ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ï‡πà‡∏≤‡∏á‡πÜ
    function wireUpButtons() {
      const addBtn = document.getElementById('addToCartBtn');
      if (addBtn) addBtn.addEventListener('click', handleAddToCart);
      
      const buyNowBtn = document.getElementById('buyNowBtn');
      if (buyNowBtn) buyNowBtn.addEventListener('click', handleBuyNow);
      
      initializeQuantityControls();
    }

    // initialize on DOM ready
    document.addEventListener('DOMContentLoaded', () => {
      // 1. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Badge ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÇ‡∏´‡∏•‡∏î
      updateCartBadge();
      
      // 2. ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
      loadProductDataAndRender();
      
      // 3. ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏õ‡∏∏‡πà‡∏°
      wireUpButtons();
      
      // 4. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Accordion
      initializeAccordion();
    });

  </script>
 </body>
 </html>
