<!doctype html>
<html lang="th">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="pageTitle">Nexus Wear - Product Detail</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&amp;family=Bebas+Neue&amp;display=swap" rel="stylesheet">
  <style>
        /* CSS เดิมทั้งหมดของคุณ - ห้ามลบหรือแก้ไข */
        body { box-sizing: border-box; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; overflow-x: hidden; }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background: #FFFFFF; color: #000000; line-height: 1.6; -webkit-font-smoothing: antialiased; }
        .page-wrapper { width: 100%; min-height: 100%; }

        /* Navigation */
        .top-nav { position: fixed; top: 0; left: 0; right: 0; background: #FFFFFF; z-index: 1000; border-bottom: 2px solid #000000; }
        .nav-content { max-width: 1600px; margin: 0 auto; padding: 0 60px; display: flex; align-items: center; justify-content: space-between; height: 80px; }
        .logo-text { font-family: 'Bebas Neue', cursive; font-size: 28px; text-decoration: none; color: #000000; letter-spacing: 2px; }
        .main-nav-list { display: flex; gap: 48px; list-style: none; align-items: center; }
        .nav-link { font-size: 14px; font-weight: 600; text-transform: uppercase; text-decoration: none; color: #000000; position: relative; }
        .nav-icons { display: flex; gap: 8px; align-items: center; }
        .icon-btn { cursor: pointer; background: none; border: none; padding: 8px; position: relative; }
        
        .cart-badge { 
            position: absolute; top: 2px; right: 2px; background: #000000; color: #FFFFFF; 
            font-size: 11px; font-weight: 700; min-width: 18px; height: 18px; 
            border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            opacity: 0; transform: scale(0); transition: all 0.3s;
        }
        .cart-badge.active { opacity: 1; transform: scale(1); }

        /* Product Layout */
        .product-container { max-width: 1600px; margin: 80px auto 0; padding: 60px; display: grid; grid-template-columns: 1fr 1fr; gap: 80px; }
        .product-gallery { position: sticky; top: 140px; display: flex; flex-direction: column; gap: 20px; }
        .main-image { width: 100%; background: #F5F5F5; border: 2px solid #000000; aspect-ratio: 1/1; overflow: hidden; }
        .main-image img { width: 100%; height: 100%; object-fit: cover; }
        
        .product-info { display: flex; flex-direction: column; gap: 32px; }
        .breadcrumb { font-size: 12px; font-weight: 600; letter-spacing: 2px; color: #666; text-transform: uppercase; }
        .product-title { font-family: 'Bebas Neue', cursive; font-size: 72px; line-height: 1; color: #000; }
        .price-tag { font-size: 32px; font-weight: 800; color: #000; }

        /* Options */
        .option-group { display: flex; flex-direction: column; gap: 16px; }
        .option-label { font-size: 12px; font-weight: 700; letter-spacing: 2px; text-transform: uppercase; }
        .size-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
        .size-btn { padding: 16px; border: 2px solid #000; background: #FFF; font-weight: 700; cursor: pointer; transition: all 0.3s; }
        .size-btn:hover { background: #F5F5F5; }
        .size-btn.active { background: #000; color: #FFF; }

        .qty-input { display: flex; align-items: center; border: 2px solid #000; width: fit-content; }
        .qty-btn { padding: 12px 20px; background: none; border: none; cursor: pointer; font-size: 20px; font-weight: 700; }
        .qty-number { padding: 0 20px; font-weight: 700; font-size: 18px; border-left: 2px solid #000; border-right: 2px solid #000; }

        /* Actions */
        .action-btns { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 16px; }
        .btn-primary { 
            padding: 24px; background: #000; color: #FFF; border: 2px solid #000; 
            font-weight: 800; text-transform: uppercase; cursor: pointer; 
            clip-path: polygon(5% 0%, 95% 0%, 100% 50%, 95% 100%, 5% 100%, 0% 50%); 
            transition: transform 0.3s;
        }
        .btn-secondary { 
            padding: 24px; background: #FFF; color: #000; border: 2px solid #000; 
            font-weight: 800; text-transform: uppercase; cursor: pointer; 
            clip-path: polygon(5% 0%, 95% 0%, 100% 50%, 95% 100%, 5% 100%, 0% 50%);
        }
        .btn-primary:hover { transform: scale(1.02); }

        /* Toast */
        .toast {
            position: fixed; bottom: 40px; right: 40px; background: #000; color: #FFF;
            padding: 20px 40px; font-weight: 700; z-index: 2000; display: none;
            clip-path: polygon(5% 0%, 95% 0%, 100% 50%, 95% 100%, 5% 100%, 0% 50%);
        }

        @media (max-width: 968px) {
            .product-container { grid-template-columns: 1fr; padding: 30px 24px; }
            .product-gallery { position: static; }
            .product-title { font-size: 56px; }
        }
    </style>
 </head>
 <body>
  <div class="page-wrapper">
   <header class="top-nav">
    <nav class="nav-content">
     <a href="index.html" class="logo-text">NEXUS WEAR</a>
     <ul class="main-nav-list">
      <li><a href="index.html#new" class="nav-link">New Drops</a></li>
      <li><a href="index.html#collections" class="nav-link">Collections</a></li>
     </ul>
     <div class="nav-icons">
      <a href="cart.html" class="icon-btn">
       <svg width="26" height="26" viewbox="0 0 24 24" fill="none" stroke="#000" stroke-width="2.5"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>
       <span class="cart-badge" id="cartBadge">0</span>
      </a>
     </div>
    </nav>
   </header>

   <main class="product-container">
    <div class="product-gallery">
     <div class="main-image">
      <img id="productImg" src="" alt="Product">
     </div>
    </div>

    <div class="product-info">
     <div class="breadcrumb" id="productCat">CATEGORY</div>
     <h1 class="product-title" id="productTitle">PRODUCT NAME</h1>
     <div class="price-tag" id="productPrice">฿0</div>

     <div class="option-group">
      <div class="option-label">SELECT SIZE</div>
      <div class="size-grid">
       <button class="size-btn">S</button>
       <button class="size-btn active">M</button>
       <button class="size-btn">L</button>
       <button class="size-btn">XL</button>
      </div>
     </div>

     <div class="option-group">
      <div class="option-label">QUANTITY</div>
      <div class="qty-input">
       <button class="qty-btn" id="minusBtn">-</button>
       <span class="qty-number" id="qtyNum">1</span>
       <button class="qty-btn" id="plusBtn">+</button>
      </div>
     </div>

     <div class="action-btns">
      <button class="btn-primary" id="buyNowBtn">BUY IT NOW</button>
      <button class="btn-secondary" id="addCartBtn">ADD TO CART</button>
     </div>
    </div>
   </main>
  </div>

  <div id="toast" class="toast">ADDED TO CART!</div>

  <script>
    /**
     * ============================================================
     * NEXUS WEAR - PRODUCT ENGINE (Professional Standard)
     * ============================================================
     */

    // 1. Data Source (ต้องตรงกับ index.html)
    const PRODUCTS = [
        { id: 'p001', name: 'Classic Black Tee', price: 790, category: 'TEE', image: 'https://hnungh.github.io/mcl/img/oversized-tee-black.jpg' },
        { id: 'p002', name: 'Military Olive Pants', price: 1590, category: 'PANTS', image: 'https://hnungh.github.io/mcl/img/cargo-pants-olive.jpg' },
        { id: 'p003', name: 'Oversize Hoodie', price: 1290, category: 'HOODIE', image: 'https://hnungh.github.io/mcl/img/hoodie-grey.jpg' },
        { id: 'p004', name: 'Retro Sunglasses', price: 490, category: 'ACC', image: 'https://hnungh.github.io/mcl/img/sunglasses-retro.jpg' }
    ];

    // 2. Global Cart Manager
    const CartManager = {
        key: 'nexus_wear_cart',
        getCart() {
            return JSON.parse(localStorage.getItem(this.key)) || [];
        },
        saveCart(cart) {
            localStorage.setItem(this.key, JSON.stringify(cart));
            this.updateBadge();
        },
        addItem(product, qty, size) {
            let cart = this.getCart();
            // สินค้าตัวเดียวกันแต่คนละไซส์ ถือเป็นคนละ SKU (สากล)
            const existingIndex = cart.findIndex(item => item.id === product.id && item.size === size);
            
            if (existingIndex > -1) {
                cart[existingIndex].qty += qty;
            } else {
                cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    image: product.image,
                    size: size,
                    qty: qty
                });
            }
            this.saveCart(cart);
        },
        updateBadge() {
            const cart = this.getCart();
            const total = cart.reduce((sum, item) => sum + item.qty, 0);
            const badge = document.getElementById('cartBadge');
            if (badge) {
                badge.innerText = total;
                badge.classList.toggle('active', total > 0);
            }
        }
    };

    // 3. UI Controller
    let currentQty = 1;
    let selectedSize = 'M';
    let currentProduct = null;

    function initProductPage() {
        const urlParams = new URLSearchParams(window.location.search);
        const productId = urlParams.get('id');
        currentProduct = PRODUCTS.find(p => p.id === productId);

        if (!currentProduct) {
            window.location.href = 'index.html'; // ถ้าไม่เจอสินค้าให้กลับหน้าแรก
            return;
        }

        // Render Product Data
        document.getElementById('productTitle').innerText = currentProduct.name;
        document.getElementById('pageTitle').innerText = `Nexus Wear - ${currentProduct.name}`;
        document.getElementById('productPrice').innerText = `฿${currentProduct.price.toLocaleString()}`;
        document.getElementById('productImg').src = currentProduct.image;
        document.getElementById('productCat').innerText = currentProduct.category;

        // Size Selection Logic
        const sizeBtns = document.querySelectorAll('.size-btn');
        sizeBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                sizeBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                selectedSize = btn.innerText;
            });
        });

        // Quantity Logic
        const qtyNum = document.getElementById('qtyNum');
        document.getElementById('plusBtn').onclick = () => { currentQty++; qtyNum.innerText = currentQty; };
        document.getElementById('minusBtn').onclick = () => { 
            if (currentQty > 1) { currentQty--; qtyNum.innerText = currentQty; }
        };

        // Cart Actions
        document.getElementById('addCartBtn').onclick = () => {
            CartManager.addItem(currentProduct, currentQty, selectedSize);
            showToast(`ADDED ${currentProduct.name} (SIZE ${selectedSize})`);
        };

        document.getElementById('buyNowBtn').onclick = () => {
            CartManager.addItem(currentProduct, currentQty, selectedSize);
            window.location.href = 'cart.html';
        };

        CartManager.updateBadge();
    }

    function showToast(msg) {
        const toast = document.getElementById('toast');
        toast.innerText = msg;
        toast.style.display = 'block';
        setTimeout(() => { toast.style.display = 'none'; }, 3000);
    }

    document.addEventListener('DOMContentLoaded', initProductPage);
  </script>
 </body>
</html>
